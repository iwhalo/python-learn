<!--
æ–‡ä»¶: index.html
ç”¨é€”: å©šç¤¼é‚€è¯·å‡½ç½‘ç«™é¦–é¡µæ¨¡æ¿
åŠŸèƒ½: å±•ç¤ºå©šç¤¼åŸºæœ¬ä¿¡æ¯ã€å€’è®¡æ—¶ã€ç›¸å†Œé¢„è§ˆã€å¯¼èˆªé“¾æ¥ç­‰
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- é¡µé¢åŸºç¡€ä¿¡æ¯è®¾ç½® -->
    <meta charset="UTF-8">
    <!-- å“åº”å¼è®¾è®¡è§†å£è®¾ç½® -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- é¡µé¢æ ‡é¢˜ï¼ŒåŠ¨æ€æ˜¾ç¤ºå©šç¤¼æ ‡é¢˜æˆ–é»˜è®¤æ–‡æœ¬ -->
    <title>{{ wedding_event.title|default:"å©šç¤¼é‚€è¯·" }} - æˆ‘ä»¬çš„ç‰¹åˆ«æ—¥å­</title>
    <!-- å¼•å…¥æœ¬åœ°æ ·å¼è¡¨ -->
    <link rel="stylesheet" href="/static/css/style.css">
    <!-- å¼•å…¥Google Fontsä¸­æ–‡å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="music-player">
        <audio id="background-music" src="/static/music/background.mp3" loop autoplay></audio>
        <div id="music-icon" class="playing"></div>
    </div>

    <div id="petal-container"></div>

    <div class="fullpage-wrapper">
        <section class="cover-page">
            <div class="cover-content">
                <h1>{{ wedding_event.bride_name|default:"æ–°å¨˜" }} & {{ wedding_event.groom_name|default:"æ–°éƒ" }}</h1>
                <p>è¯šæŒšé‚€è¯·æ‚¨å‚åŠ æˆ‘ä»¬çš„å©šç¤¼</p>
            </div>
            <a href="#main-content" class="scroll-down-arrow">
                <span></span>
            </a>
        </section>
        <section>
            <div class="container">
                <!-- é¡µé¢å¤´éƒ¨åŒºåŸŸï¼Œæ˜¾ç¤ºå©šç¤¼æ ‡é¢˜å’Œæ–°äººå§“å -->
                <div class="header">
                    <!-- åŠ¨æ€æ˜¾ç¤ºå©šç¤¼æ ‡é¢˜ï¼Œå¦‚æœæœªè®¾ç½®åˆ™æ˜¾ç¤ºé»˜è®¤æ–‡æœ¬ -->
                    <h1>{{ wedding_event.title|default:"æˆ‘ä»¬çš„å©šç¤¼" }}</h1>
        
                    <!-- æ¡ä»¶æ˜¾ç¤ºæ–°äººå§“åï¼Œåªæœ‰å½“æ–°å¨˜å’Œæ–°éƒå§“åéƒ½å­˜åœ¨æ—¶æ‰æ˜¾ç¤º -->
                    {% if wedding_event.bride_name and wedding_event.groom_name %}
                    <!-- æ–°äººå§“åå±•ç¤ºåŒºåŸŸï¼Œä½¿ç”¨flexå¸ƒå±€å¹¶æ’æ˜¾ç¤º -->
                    <div class="couple-names">
                        <!-- æ˜¾ç¤ºæ–°å¨˜å§“å -->
                        <div class="name">{{ wedding_event.bride_name }}</div>
                        <!-- åˆ†éš”ç¬¦ -->
                        <div class="name">&</div>
                        <!-- æ˜¾ç¤ºæ–°éƒå§“å -->
                        <div class="name">{{ wedding_event.groom_name }}</div>
                    </div>
                    {% endif %}
        
                    <p class="invitation-text">
                        è¯šæŒšé‚€è¯·æ‚¨å‚åŠ æˆ‘ä»¬çš„å©šç¤¼
                    </p>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <!-- å©šç¤¼è¯¦æƒ…å¡ç‰‡ï¼Œæ˜¾ç¤ºå©šç¤¼çš„å…·ä½“ä¿¡æ¯ -->
                <!-- åªæœ‰å½“å­˜åœ¨å©šç¤¼äº‹ä»¶æ—¶æ‰æ˜¾ç¤ºè¯¦æƒ… -->
                {% if wedding_event %}
                <div class="event-card">
                    <!-- å©šç¤¼è¯¦æƒ…æ ‡é¢˜ -->
                    <h2>å©šç¤¼è¯¦æƒ…</h2>
                    <!-- å©šç¤¼è¯¦æƒ…ç½‘æ ¼å¸ƒå±€ -->
                    <div class="event-details">
                        <!-- å©šç¤¼æ—¥æœŸä¿¡æ¯ -->
                        <div class="detail-item">
                            <h3>å©šç¤¼æ—¥æœŸ</h3>
                            <!-- ä½¿ç”¨Djangoæ¨¡æ¿è¿‡æ»¤å™¨æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´ -->
                            <p>{{ wedding_event.event_date|date:"Yå¹´mæœˆdæ—¥ H:i" }}</p>
                        </div>
                        <!-- å©šç¤¼ä¸¾åŠåœ°ç‚¹ä¿¡æ¯ -->
                        <div class="detail-item">
                            <h3>ä¸¾åŠåœ°ç‚¹</h3>
                            <p>{{ wedding_event.venue }}</p>
                        </div>
                        <!-- å©šç¤¼è¯¦ç»†åœ°å€ä¿¡æ¯ -->
                        <div class="detail-item">
                            <h3>è¯¦ç»†åœ°å€</h3>
                            <p>{{ wedding_event.address }}</p>
                        </div>
                    </div>
        
                    {% if wedding_event.description %}
                    <div class="detail-item description-item">
                        <h3>å©šç¤¼æè¿°</h3>
                        <p>{{ wedding_event.description|linebreaks }}</p>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </section>

        <section class="section">
            <div class="container">
                <!-- å©šç¤¼å€’è®¡æ—¶åŒºåŸŸï¼Œæ˜¾ç¤ºè·ç¦»å©šç¤¼è¿˜å‰©å¤šé•¿æ—¶é—´ -->
                <div class="countdown-section">
                    <!-- å€’è®¡æ—¶æ ‡é¢˜ -->
                    <h2 class="countdown-title">è·ç¦»æˆ‘ä»¬çš„å¤§æ—¥å­è¿˜æœ‰</h2>
                    <!-- å€’è®¡æ—¶è®¡æ—¶å™¨ï¼ŒåŒ…å«å¤©ã€å°æ—¶ã€åˆ†é’Ÿã€ç§’å››ä¸ªéƒ¨åˆ† -->
                    <div class="countdown-timer">
                        <!-- å¤©æ•°å€’è®¡æ—¶ -->
                        <div class="countdown-item">
                            <!-- å¤©æ•°æ˜¾ç¤ºå…ƒç´ ï¼ŒIDç”¨äºJavaScriptæ›´æ–° -->
                            <div class="countdown-number" id="days">00</div>
                            <div class="countdown-label">å¤©</div>
                        </div>
                        <!-- å°æ—¶å€’è®¡æ—¶ -->
                        <div class="countdown-item">
                            <!-- å°æ—¶æ˜¾ç¤ºå…ƒç´ ï¼ŒIDç”¨äºJavaScriptæ›´æ–° -->
                            <div class="countdown-number" id="hours">00</div>
                            <div class="countdown-label">å°æ—¶</div>
                        </div>
                        <!-- åˆ†é’Ÿå€’è®¡æ—¶ -->
                        <div class="countdown-item">
                            <!-- åˆ†é’Ÿæ˜¾ç¤ºå…ƒç´ ï¼ŒIDç”¨äºJavaScriptæ›´æ–° -->
                            <div class="countdown-number" id="minutes">00</div>
                            <div class="countdown-label">åˆ†é’Ÿ</div>
                        </div>
                        <!-- ç§’æ•°å€’è®¡æ—¶ -->
                        <div class="countdown-item">
                            <!-- ç§’æ•°æ˜¾ç¤ºå…ƒç´ ï¼ŒIDç”¨äºJavaScriptæ›´æ–° -->
                            <div class="countdown-number" id="seconds">00</div>
                            <div class="countdown-label">ç§’</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section">
            <div class="container">
                <!-- å©šçº±ç›¸å†Œé¢„è§ˆåŒºåŸŸï¼Œæ˜¾ç¤ºå©šç¤¼ç›¸å†Œä¸­çš„å›¾ç‰‡ -->
                <!-- åªæœ‰å½“å­˜åœ¨ç›¸å†Œå›¾ç‰‡æ—¶æ‰æ˜¾ç¤ºç›¸å†Œéƒ¨åˆ† -->
                {% if gallery_images %}
                <div class="gallery-section">
                    <!-- ç›¸å†Œæ ‡é¢˜ -->
                    <h2 class="gallery-title">å©šçº±ç›¸å†Œ</h2>
                    <!-- å›¾ç‰‡ç½‘æ ¼å¸ƒå±€ -->
                    <div class="image-gallery">
                        <!-- éå†ç›¸å†Œå›¾ç‰‡åˆ—è¡¨ -->
                        {% for image in gallery_images %}
                        <div class="gallery-item">
                            <!-- æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™æ˜¾ç¤ºå®é™…å›¾ç‰‡ï¼Œå¦åˆ™æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡ -->
                            {% if image.has_image %}
                            <!-- æ˜¾ç¤ºå®é™…çš„ç›¸å†Œå›¾ç‰‡ -->
                            <img src="{{ image.get_image_url }}" alt="{{ image.title }}">
                            {% else %}
                            <!-- æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡ï¼Œå¦‚æœé»˜è®¤å›¾ç‰‡ä¹ŸåŠ è½½å¤±è´¥åˆ™æ˜¾ç¤ºå¤‡ç”¨å›¾ç‰‡ -->
                            <img src="/static/images/default_gallery.jpg" alt="{{ image.title }}" onerror="this.onerror=null;this.src='/static/images/default_image.png';">
                            {% endif %}
                            <!-- å›¾ç‰‡å†…å®¹åŒºåŸŸï¼Œæ˜¾ç¤ºå›¾ç‰‡æ ‡é¢˜ -->
                            <div class="gallery-item-content">
                                <div class="gallery-item-title-wrapper">
                                    <!-- æ˜¾ç¤ºå›¾ç‰‡æ ‡é¢˜ -->
                                    <h4>{{ image.title }}</h4>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </section>

        <section class="section">
            <div class="container">
                <!-- å¯¼èˆªé“¾æ¥åŒºåŸŸï¼Œæä¾›åˆ°å„ä¸ªåŠŸèƒ½é¡µé¢çš„å¿«é€Ÿè®¿é—® -->
                <div class="nav-links">
                    <!-- å©šç¤¼å€’è®¡æ—¶é¡µé¢é“¾æ¥ -->
                    <a href="{% url 'countdown' %}" class="nav-link">å©šç¤¼å€’è®¡æ—¶</a>
                    <!-- å©šçº±ç›¸å†Œé¡µé¢é“¾æ¥ -->
                    <a href="{% url 'gallery' %}" class="nav-link">å©šçº±ç›¸å†Œ</a>
                    <!-- å®¾å®¢åˆ—è¡¨é¡µé¢é“¾æ¥ -->
                    <a href="{% url 'guest_list' %}" class="nav-link">å®¾å®¢åˆ—è¡¨</a>
                    <!-- åœ°å›¾ä½ç½®é¡µé¢é“¾æ¥ -->
                    <a href="{% url 'map' %}" class="nav-link">åœ°å›¾ä½ç½®</a>
                    <!-- RSVPç¡®è®¤å‡ºå¸­é¡µé¢é“¾æ¥ -->
                    <a href="{% url 'rsvp' %}" class="nav-link">ç¡®è®¤å‡ºå¸­</a>
                </div>
    
                <!-- RSVPç¡®è®¤å‡ºå¸­æŒ‰é’®ï¼Œå¼•å¯¼ç”¨æˆ·ç¡®è®¤æ˜¯å¦å‚åŠ å©šç¤¼ -->
                <div class="rsvp-section">
                    <!-- é“¾æ¥åˆ°RSVPé¡µé¢ï¼Œè®©ç”¨æˆ·ç¡®è®¤å‡ºå¸­æˆ–å‘é€ç¥ç¦ -->
                    <a href="{% url 'rsvp' %}" class="rsvp-button">ç¡®è®¤å‡ºå¸­ / å‘é€ç¥ç¦</a>
                </div>
    
                <!-- é¡µé¢è®¿é—®ç»Ÿè®¡ä¿¡æ¯ï¼Œæ˜¾ç¤ºå½“å‰é¡µé¢è¢«è®¿é—®çš„æ¬¡æ•° -->
                <div class="visit-stats">
                    <p>
                        <strong>é¡µé¢è®¿é—®ç»Ÿè®¡:</strong>
                        <!-- æ˜¾ç¤ºé¦–é¡µè®¿é—®æ¬¡æ•°ï¼Œå¦‚æœæ²¡æœ‰ç»Ÿè®¡æ•°æ®åˆ™æ˜¾ç¤º0 -->
                        æœ¬é¡µé¢å·²è¢«è®¿é—® <span class="visit-count">{{ homepage_visit_count|default:0 }}</span> æ¬¡
                    </p>
                </div>
    
                <footer class="footer">
                    <p>æ„¿æˆ‘ä»¬çš„çˆ±ï¼Œå¦‚æ˜Ÿè¾°å¤§æµ·ï¼Œæ°¸æ’é—ªè€€ã€‚</p>
                    <p>&copy; 2024 {{ wedding_event.groom_name|default:'æ–°éƒ' }} & {{ wedding_event.bride_name|default:'æ–°å¨˜' }}. All Rights Reserved.</p>
                </footer>
            </div>
        </section>
    </div>

    <script>
        // å©šç¤¼å€’è®¡æ—¶åŠŸèƒ½
        function updateCountdown() {
            const weddingDateStr = '{{ wedding_event.event_date|date:"Y-m-d H:i:s" }}';
            if (!weddingDateStr) return;
    
            const weddingDate = new Date(weddingDateStr);
            const now = new Date();
    
            let diff = weddingDate - now;
    
            if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
    
                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            } else {
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
            }
        }

        // èŠ±ç“£é£˜è½åŠ¨ç”»
        function createPetal() {
            const petalContainer = document.getElementById('petal-container');
            if (!petalContainer) return;
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.style.left = Math.random() * window.innerWidth + 'px';
            petal.textContent = ['ğŸŒ¹','ğŸŒ¸','ğŸ’','ğŸ¥€','ğŸŒº'][Math.floor(Math.random()*5)];
            petalContainer.appendChild(petal);
            setTimeout(() => petal.remove(), 6000);
        }

        // é¡µé¢åŠ è½½å®Œæˆåè¿è¡Œçš„è„šæœ¬
        document.addEventListener('DOMContentLoaded', function() {
            // éŸ³ä¹æ’­æ”¾å™¨åŠŸèƒ½
            const musicIcon = document.getElementById('music-icon');
            const backgroundMusic = document.getElementById('background-music');
            if (backgroundMusic) {
                if (backgroundMusic.paused) {
                    musicIcon.classList.remove('playing');
                }
                let playPromise = backgroundMusic.play();
                if (playPromise !== undefined) {
                    playPromise.catch(() => {
                        musicIcon.classList.remove('playing');
                    });
                }
                musicIcon.addEventListener('click', function() {
                    if (backgroundMusic.paused) {
                        backgroundMusic.play();
                        musicIcon.classList.add('playing');
                    } else {
                        backgroundMusic.pause();
                        musicIcon.classList.remove('playing');
                    }
                });
            }

            // åˆå§‹åŒ–å€’è®¡æ—¶å¹¶è®¾ç½®æ¯ç§’æ›´æ–°ä¸€æ¬¡
            updateCountdown();
            setInterval(updateCountdown, 1000);

            // åˆå§‹åŒ–èŠ±ç“£é›¨
            setInterval(createPetal, 700);

            // ä¸ºé¡µé¢ä¸»è¦å…ƒç´ æ·»åŠ å…¥åœºåŠ¨ç”»æ•ˆæœ
            const elements = document.querySelectorAll('.event-card, .countdown-section, .gallery-section, .rsvp-section, .visit-stats');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 200);
            });
        });
    </script>
</body>
</html>